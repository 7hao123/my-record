# BI 低代码可视化画布项目亮点分析（前端面试向·技术细节增强版）

## 项目一句话定位（BI 低代码）
将 BI 报表/看板抽象为可持久化的 Box Schema，通过“编辑器运行时 + 渲染运行时 + 物料协议 + 数据驱动”实现配置化搭建、交互分析与可复用资产沉淀。

---

## 前端架构抽象（核心设计能力）

### 1) Editor Runtime（编辑器运行时）
- 画布交互引擎：拖拽/缩放/旋转/框选/多选/吸附/对齐线
- 组合与层级：分组、ZIndex、显示隐藏、容器内布局（Tabs）
- 状态统一：交互状态与画布状态统一进入 Redux，支持撤销/重做

### 2) Renderer Runtime（渲染运行时）
- 运行时只消费 `canvas + boxList`，按几何与配置渲染
- Box → BoxContent 的组件映射表派发，组件 self‑contained（自管理数据请求与渲染）

### 3) 物料协议层（Material Registry）
- `boxTypes` 统一定义：默认尺寸、配置结构、数据约束、chartConfig/tableConfig
- 新增组件只需注册物料，不改画布核心；支持图表类型切换与配置迁移

### 4) BI 数据与交互层
- React Query 统一数据请求与缓存
- `useRequestParams` 统一拼装 BI 查询参数（维度/指标/筛选/钻取/排序/同比环比）
- 钻取由图表事件驱动，触发维度 active 切换并刷新数据

### 5) 预览/导出与发布
- 预览运行时独立，支持适屏/适宽/原始比例
- PDF 导出通过组件边界分页切割，避免图表/表格截断

---

## 关键技术细节（前端面试可直接讲）

### 1) 画布交互引擎（Moveable + Selecto）
- 多选框选、拖拽缩放旋转、对齐线与吸附
- 分组组件保持一致性更新，组内拖拽/缩放同步
- 快捷操作（复制粘贴、方向键微调、删除）

### 2) 编辑状态可回放（Redux + redux‑undo）
- 单一状态源 `editorSlice` 管理 `canvas + boxList`
- 原子化更新动作，支持撤销/重做
- 选中态与编辑态隔离，降低状态污染

### 3) Schema → Renderer 派发
- BoxContent 统一映射组件类型
- 运行时渲染只依赖配置，编辑器与渲染解耦

### 4) BI 组件体系与配置迁移
- 图表/表格统一配置结构（chartConfig/tableConfig）
- `switchBoxType` 支持图表类型切换，配置迁移保留公共字段
- `requestableCheckers` 限制维度/指标数量，避免非法请求

### 5) 数据驱动 UI
- `useBoxData` 处理加载态/错误态/空数据
- `useRequestParams` 聚合筛选器、钻取条件、维度成员、同比/环比
- 数据变化驱动视图更新，保障分析闭环

### 6) 容器级布局与可见性（Tabs）
- 拖入 Tabs 容器自动绑定 `tabsId/paneId`
- `useBoxList` 控制容器内可见性，实现“容器级布局管理”

### 7) 预览与导出体验
- viewMode 支持适屏/适宽/原始比例
- PDF 导出基于组件边界计算分页切点，避免组件被截断

---

## 技术难点 & 解决方案（前端高频问法）

### 难点 1：高交互状态管理
- **挑战**：多选/拖拽/缩放/组合/编辑态互相干扰
- **方案**：交互状态集中 Redux；Moveable/Selecto 统一触发；结果只写入 boxList
- **收益**：逻辑可预测，可撤销，减少回归问题

### 难点 2：画布与业务组件解耦
- **挑战**：画布负责交互，但不应绑定具体业务
- **方案**：Box 只保存几何与配置；组件 self‑contained 自己拉数据
- **收益**：画布通用化，业务组件可独立演进

### 难点 3：BI 查询参数复杂拼装
- **挑战**：筛选、钻取、时间范围、排序、同比/环比组合复杂
- **方案**：统一入口 `useRequestParams` 生成参数
- **收益**：避免重复逻辑，降低出错率

### 难点 4：组件类型切换与兼容
- **挑战**：图表类型切换易造成历史配置失效
- **方案**：物料协议统一入口 + 配置迁移函数
- **收益**：支持图表切换，提升用户体验

### 难点 5：导出报表的可用性
- **挑战**：复杂看板导出易截断组件
- **方案**：分页算法结合组件边界计算切点
- **收益**：导出质量接近企业级 BI 产品

---

## 对齐主流 BI 低代码能力（前端视角）
- 配置驱动渲染（Schema/Box）
- 物料插件化（boxTypes 注册）
- 编辑态/预览态分离
- 交互分析能力（筛选/钻取/联动）
- 资产复用（组件与组合资源化）

---

## 面试可直接讲的亮点关键词
- BI 低代码：指标/维度建模 + 配置驱动
- Moveable + Selecto 交互引擎
- Redux + redux‑undo 的可回放状态
- 组件自管理数据 + 统一请求参数
- 运行时渲染与编辑器解耦
- 预览与导出分页算法
